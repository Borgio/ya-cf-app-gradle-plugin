A Gradle plugin to push an application to Cloud Foundry. 

== Using the Plugin

* Add a buildscript dependency:

[source]
----
buildscript {
	ext {
		cfPushVersion = '1.0.0-SNAPSHOT'
	}
	repositories {
		mavenLocal()
		mavenCentral()
		maven {
			url 'https://repo.spring.io/libs-milestone'
		}
	}
	dependencies {
		classpath("io.pivotal.services:cf-push-gradle-plugin:${cfPushVersion}")
	}
}
----

* Apply the plugin and provide the Cloud Foundry details:

[source]
----
apply plugin: 'cf-push'

cfConfig {
	name = "Blue"
	hostName = "demo-time"
	filePath = "build/libs/cf-show-env-0.1.2-SNAPSHOT.jar"

	ccHost = "api.local.pcfdev.io"
	ccUser = "admin"
	ccPassword = "admin"
	org = "pcfdev-org"
	space = "pcfdev-space"
	domain = "local.pcfdev.io"

	buildpack = "https://github.com/cloudfoundry/java-buildpack.git"
	environment = ["JAVA_OPTS": "-Djava.security.egd=file:/dev/./urandom", "SPRING_PROFILES_ACTIVE": "cloud"]
	services  = ["mydb"]
}
----

* Run the task:

[source]
----
./gradlew cf-push
----

* Override the values using explicit gradle properties, they follow a `cf.*` pattern:

[source]
----
./gradlew cf-push -Pcf.name=Green -Pcf.hostName=demo-time-temp
----


== Using the Plugin for a Blue-Green Application Deployment

* Provide a default set of configuration along the lines described above

* Push the `Blue` app mapping to `demo-time.domain`:
[source]
----
./gradlew cf-push -Pcf.name=Blue -Pcf.hostName=demo-time
----

* Push the `Green` app mapping to `demo-time-temp.domain`:
[source]
----
./gradlew cf-push -Pcf.name=Green -Pcf.hostName=demo-time-temp
----

* Once `Green` is verified, remap the route for `Green`:
[source]
----
./gradlew cf-map-route -Pcf.name=Green -Pcf.hostName=demo-time
----

* Unmap the temporary route for Green:
[source]
----
./gradlew cf-unmap-route -Pcf.name=Green -Pcf.hostName=demo-time-temp
----

* Delete the Blue app:
[source]
----
./gradlew cf-delete-app -Pcf.name=Blue
----

* Delete the temporary route:
[source]
----
./gradlew cf-delete-route -Pcf.hostName=demo-time-temp
----